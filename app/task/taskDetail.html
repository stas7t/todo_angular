<section ng-switch="taskDetail.editMode">
  <div class="row task mx-0" ng-switch-default>
    <div class="px-2 py-1 task-actions">
      <div>
        <a href=""><i class="fa fa-long-arrow-up" aria-hidden="true"></i></a>
      </div>
      <div>
        <a href=""><i class="fa fa-long-arrow-down" aria-hidden="true"></i></a>
      </div>
    </div>
    <div class="px-1 py-2">
      <input type="checkbox" ng-model="taskDetail.task.completed" ng-change="taskDetail.update()">
    </div>
    <div class="col px-1 py-2">
      <div>
        <span ng-class="{'task-completed' : taskDetail.task.completed}">{{ taskDetail.task.name }}</span>
      </div>
      <div class="deadline text-smaller" ng-if="taskDetail.task.deadline">{{ taskDetail.task.deadline.date | date: "dd/MM/yyyy" }} {{ taskDetail.task.deadline.time | date: "HH:mm" }}</div>
    </div>
    <div class="p-2 task-actions">
      {{ taskDetail.task.comments.length }} 
      <a href="" data-toggle="modal" data-target="#commentsModal-{{taskDetail.task.id}}"><i class="fa fa-comment fa-lg" aria-hidden="true"></i></a>
      <a href="" data-toggle="modal" data-target="#deadlineModal-{{taskDetail.task.id}}"><i class="fa fa-clock-o fa-lg" aria-hidden="true"></i></a>
      <a href="" ng-click="taskDetail.edit()"><i class="fa fa-pencil fa-lg" aria-hidden="true"></i></a>
      <a href="" ng-click="taskDetail.delete()"><i class="fa fa-trash-o fa-lg" aria-hidden="true"></i></a>
    </div>
    <!--div class="pull-rigth"  style="position: absolute; background-color: red; border: 1px solid green; left:100%;">
      x
      <deadline-form deadline="taskDetail.task.deadline" project-id="taskDetail.task.project_id" task-id="taskDetail.task.id"></deadline-form>
    </div-->
  </div>

  <form ng-switch-when="true" ng-submit="taskDetail.save()" name="editTask">
    <div class="form-group mt-minus-1">
      <input type="text" class="form-control rounded-0" ng-model="taskDetail.task.name" autofocus required>
    </div>
    <div class="form-group">
      <button class="btn btn-success" type="submit">Save</button>
      <button class="btn btn-light" type="button" ng-click="taskDetail.reset()">Cancel</button>
    </div>
  </form>
</section>

<!-- Modal -->
<div class="modal fade" id="deadlineModal-{{taskDetail.task.id}}" tabindex="-1" role="dialog" aria-labelledby="deadlineModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deadlineModalLabel">Deadline</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <deadline-form deadline="taskDetail.task.deadline" project-id="taskDetail.task.project_id" task-id="taskDetail.task.id" on-change="taskDetail.change()"></deadline-form>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="commentsModal-{{taskDetail.task.id}}" tabindex="-1" role="dialog" aria-labelledby="commentsModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="commentsModalLabel">Add comment</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>

        <comment-list task="taskDetail.task"></comment-list>

      </div>
    </div>
  </div>
